<%- include('../partials/header', { lang, siteName, t, currentPath, requestPath }) %>
<section class="admin-wrapper">
  <% const roleLabels = {
    Administrator: lang === 'kk' ? 'Әкімші' : 'Администратор',
    Bartender: lang === 'kk' ? 'Бармен' : 'Бармен',
    Cashier: lang === 'kk' ? 'Кассир' : 'Кассир'
  }; %>
  <div class="admin-card">
    <div style="display:flex;justify-content:space-between;align-items:center;">
      <h2><%= t('usersRoles') %></h2>
      <a class="btn btn-outline" href="/admin/dashboard?lang=<%= lang %>"><%= t('dashboard') %></a>
    </div>
    <% if (typeof error !== 'undefined') { %>
    <div class="error-message"><%= error %></div>
    <% } %>
    <div class="table-wrapper">
      <table class="table">
        <thead>
          <tr>
            <th><%= t('username') %></th>
            <th><%= t('role') %></th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <% if (!users.length) { %>
          <tr>
            <td colspan="3"><%= t('emptyState') %></td>
          </tr>
          <% } %>
          <% users.forEach(function(u){ %>
          <tr>
            <td><%= u.username %></td>
            <td><%= roleLabels[u.role] || u.role %></td>
            <td>
              <% if (u.username !== 'root') { %>
              <form method="post" action="/admin/users/<%= u.id %>/delete?lang=<%= lang %>" onsubmit="return confirm('<%= t('deleteConfirm') %>');">
                <button class="btn btn-outline" type="submit"><%= t('delete') %></button>
              </form>
              <% } %>
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
    </div>
  </div>

  <div class="admin-card">
    <h3><%= t('createUser') %></h3>
    <form method="post" action="/admin/users?lang=<%= lang %>">
      <label for="username"><%= t('username') %></label>
      <input class="form-control" type="text" name="username" id="username" required />
      <label for="role"><%= t('role') %></label>
      <select class="form-control" name="role" id="role">
        <option value="<%= roles.ADMIN %>"><%= roleLabels[roles.ADMIN] %></option>
        <option value="<%= roles.BARMEN %>"><%= roleLabels[roles.BARMEN] %></option>
        <option value="<%= roles.CASHIER %>"><%= roleLabels[roles.CASHIER] %></option>
      </select>
      <label for="password"><%= t('password') %></label>
      <input class="form-control" type="password" name="password" id="password" required />
      <label for="passwordConfirm"><%= t('passwordConfirm') %></label>
      <input class="form-control" type="password" name="passwordConfirm" id="passwordConfirm" required />
      <button class="btn btn-primary" type="submit"><%= t('save') %></button>
    </form>
  </div>
</section>
<%- include('../partials/footer', { t }) %>
